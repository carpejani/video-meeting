{"version":3,"sources":["Video.js","Home.js","App.js","serviceWorker.js","index.js"],"names":["connections","peerConnectionConfig","socket","socketId","elms","Video","props","getPermissions","a","navigator","mediaDevices","getUserMedia","video","then","stream","videoAvailable","catch","e","audio","audioAvailable","getDisplayMedia","setState","screenAvailable","window","localStream","localVideoref","current","srcObject","console","log","getMedia","screen","connectToSocketServer","state","getUserMediaSuccess","getTracks","forEach","track","stop","id","addStream","createOffer","description","setLocalDescription","emit","JSON","stringify","localDescription","getVideoTracks","onended","silence","ctx","AudioContext","oscillator","createOscillator","dst","connect","createMediaStreamDestination","start","resume","Object","assign","getAudioTracks","enabled","black","width","height","canvas","document","createElement","getContext","fillRect","captureStream","MediaStream","blackSilence","getDislayMedia","getDislayMediaSuccess","gotMessageFromServer","fromId","message","signal","parse","sdp","setRemoteDescription","RTCSessionDescription","type","createAnswer","ice","addIceCandidate","RTCIceCandidate","io","secure","on","location","href","addMessage","querySelector","parentNode","removeChild","main","getElementById","videos","querySelectorAll","minWidth","offsetWidth","String","length","style","minHeight","setProperty","clients","socketListId","undefined","RTCPeerConnection","onicecandidate","event","candidate","onaddstream","searchVidep","maxHeight","margin","borderStyle","borderColor","objectFit","setAttribute","autoplay","playsinline","appendChild","handleVideo","handleAudio","handleScreen","handleEndCall","openChat","showModal","newmessages","closeChat","handleMessage","target","value","data","sender","prevState","messages","sendMessage","copyUrl","text","clipboard","writeText","success","err","error","textArea","body","focus","select","execCommand","handleUsername","username","askForUsername","isChromeOrFirefox","userAgent","toLowerCase","vendor","matchChrome","test","match","matchFirefox","React","createRef","faker","internet","userName","bind","this","background","padding","textAlign","marginTop","justifyContent","fontWeight","paddingRight","Input","placeholder","onChange","Button","variant","color","onClick","paddingTop","ref","autoPlay","muted","className","backgroundColor","IconButton","Badge","badgeContent","max","Modal","show","onHide","zIndex","Header","closeButton","Title","Body","overflow","overflowY","map","item","index","key","wordBreak","Footer","disable","marginLeft","fontSize","Row","Component","Home","handleChange","url","join","includes","substring","Math","random","toString","marginBottom","App","path","exact","component","Boolean","hostname","ReactDOM","render","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5e622f27.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport io from 'socket.io-client';\nimport faker from \"faker\";\n\nimport IconButton from '@material-ui/core/IconButton';\nimport Badge from '@material-ui/core/Badge';\nimport { Input, Button } from '@material-ui/core';\nimport VideocamIcon from '@material-ui/icons/Videocam';\nimport VideocamOffIcon from '@material-ui/icons/VideocamOff';\nimport MicIcon from '@material-ui/icons/Mic';\nimport MicOffIcon from '@material-ui/icons/MicOff';\nimport ScreenShareIcon from '@material-ui/icons/ScreenShare';\nimport StopScreenShareIcon from '@material-ui/icons/StopScreenShare';\nimport CallEndIcon from '@material-ui/icons/CallEnd';\nimport ChatIcon from '@material-ui/icons/Chat';\n\nimport { message } from 'antd';\nimport 'antd/dist/antd.css';\n\nimport { Row } from 'reactstrap';\nimport Modal from 'react-bootstrap/Modal'\nimport 'bootstrap/dist/css/bootstrap.css';\nimport \"./Video.css\";\n\n// const server_url = process.env.NODE_ENV === 'production' ? 'https://video.sebastienbiollo.com' : \"http://localhost:4001\"\nconst server_url = '/'\n\nvar connections = {}\nconst peerConnectionConfig = {\n\t'iceServers': [\n\t\t// { 'urls': 'stun:stun.services.mozilla.com' },\n\t\t{ 'urls': 'stun:stun.l.google.com:19302' },\n\t]\n}\nvar socket = null\nvar socketId = null\n\nvar elms = 0\n\nclass Video extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.localVideoref = React.createRef()\n\n\t\tthis.videoAvailable = false\n\t\tthis.audioAvailable = false\n\n\t\tthis.video = false\n\t\tthis.audio = false\n\t\tthis.screen = false\n\n\t\tthis.state = {\n\t\t\tvideo: false,\n\t\t\taudio: false,\n\t\t\tscreen: false,\n\t\t\tshowModal: false,\n\t\t\tscreenAvailable: false,\n\t\t\tmessages: [],\n\t\t\tmessage: \"\",\n\t\t\tnewmessages: 0,\n\t\t\taskForUsername: true,\n\t\t\tusername: faker.internet.userName(),\n\t\t}\n\t\tconnections = {}\n\n\t\tthis.addMessage = this.addMessage.bind(this)\n\n\t\tthis.getPermissions()\n\t}\n\n\tgetPermissions = async () => {\n\t\tawait navigator.mediaDevices.getUserMedia({ video: true })\n\t\t\t.then((stream) => {\n\t\t\t\tthis.videoAvailable = true\n\t\t\t\tthis.video = true\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tthis.videoAvailable = false\n\t\t\t})\n\n\t\tawait navigator.mediaDevices.getUserMedia({ audio: true })\n\t\t\t.then((stream) => {\n\t\t\t\tthis.audioAvailable = true\n\t\t\t\tthis.audio = true\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tthis.audioAvailable = false\n\t\t\t})\n\n\t\tif (navigator.mediaDevices.getDisplayMedia) {\n\t\t\tthis.setState({\n\t\t\t\tscreenAvailable: true,\n\t\t\t})\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tscreenAvailable: false,\n\t\t\t})\n\t\t}\n\n\t\tif (this.videoAvailable || this.audioAvailable) {\n\t\t\tnavigator.mediaDevices.getUserMedia({ video: this.videoAvailable, audio: this.audioAvailable })\n\t\t\t\t.then((stream) => {\n\t\t\t\t\twindow.localStream = stream\n\t\t\t\t\tthis.localVideoref.current.srcObject = stream\n\t\t\t\t})\n\t\t\t\t.then((stream) => {})\n\t\t\t\t.catch((e) => console.log(e))\n\t\t}\n\t}\n\n\tgetMedia = () => {\n\t\tthis.setState({\n\t\t\tvideo: this.video,\n\t\t\taudio: this.audio,\n\t\t\tscreen: this.screen\n\t\t}, () => {\n\t\t\tthis.getUserMedia()\n\t\t\tthis.connectToSocketServer()\n\t\t})\n\t}\n\n\n\tgetUserMedia = () => {\n\t\tif ((this.state.video && this.videoAvailable) || (this.state.audio && this.audioAvailable)) {\n\t\t\tnavigator.mediaDevices.getUserMedia({ video: this.state.video, audio: this.state.audio })\n\t\t\t\t.then(this.getUserMediaSuccess)\n\t\t\t\t.then((stream) => {})\n\t\t\t\t.catch((e) => console.log(e))\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tlet tracks = this.localVideoref.current.srcObject.getTracks()\n\t\t\t\ttracks.forEach(track => track.stop())\n\t\t\t} catch (e) {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\n\tgetUserMediaSuccess = (stream) => {\n\t\ttry {\n\t\t\twindow.localStream.getTracks().forEach(track => track.stop())\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\n\t\twindow.localStream = stream\n\t\tthis.localVideoref.current.srcObject = stream\n\n\t\tfor (let id in connections) {\n\t\t\tif (id === socketId) continue\n\n\t\t\tconnections[id].addStream(window.localStream);\n\n\t\t\tconnections[id].createOffer().then((description) => {\n\t\t\t\tconnections[id].setLocalDescription(description)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tsocket.emit('signal', id, JSON.stringify({ 'sdp': connections[id].localDescription }));\n\t\t\t\t\t})\n\t\t\t\t\t.catch(e => console.log(e));\n\t\t\t});\n\t\t}\n\n\t\tstream.getVideoTracks()[0].onended = () => {\n\t\t\tthis.setState({\n\t\t\t\tvideo: false,\n\t\t\t\taudio: false,\n\t\t\t}, () => {\n\t\t\t\ttry {\n\t\t\t\t\tlet tracks = this.localVideoref.current.srcObject.getTracks()\n\t\t\t\t\ttracks.forEach(track => track.stop())\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(e)\n\t\t\t\t}\n\n\t\t\t\tlet silence = () => {\n\t\t\t\t\tlet ctx = new AudioContext()\n\t\t\t\t\tlet oscillator = ctx.createOscillator()\n\t\t\t\t\tlet dst = oscillator.connect(ctx.createMediaStreamDestination())\n\t\t\t\t\toscillator.start()\n\t\t\t\t\tctx.resume()\n\t\t\t\t\treturn Object.assign(dst.stream.getAudioTracks()[0], { enabled: false });\n\t\t\t\t}\n\n\t\t\t\tlet black = ({ width = 640, height = 480 } = {}) => {\n\t\t\t\t\tlet canvas = Object.assign(document.createElement(\"canvas\"), { width, height });\n\t\t\t\t\tcanvas.getContext('2d').fillRect(0, 0, width, height);\n\t\t\t\t\tlet stream = canvas.captureStream();\n\t\t\t\t\treturn Object.assign(stream.getVideoTracks()[0], { enabled: false });\n\t\t\t\t}\n\n\t\t\t\tlet blackSilence = (...args) => new MediaStream([black(...args), silence()]);\n\t\t\t\twindow.localStream = blackSilence()\n\t\t\t\tthis.localVideoref.current.srcObject = window.localStream\n\n\t\t\t\tfor (let id in connections) {\n\t\t\t\t\tconnections[id].addStream(window.localStream);\n\n\t\t\t\t\tconnections[id].createOffer().then((description) => {\n\t\t\t\t\t\tconnections[id].setLocalDescription(description)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tsocket.emit('signal', id, JSON.stringify({ 'sdp': connections[id].localDescription }));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(e => console.log(e));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\t}\n\n\n\tgetDislayMedia = () => {\n\t\tif (this.state.screen) {\n\t\t\tif (navigator.mediaDevices.getDisplayMedia) {\n\t\t\t\tnavigator.mediaDevices.getDisplayMedia({ video: true, audio: true })\n\t\t\t\t\t.then(this.getDislayMediaSuccess)\n\t\t\t\t\t.then((stream) => {})\n\t\t\t\t\t.catch((e) => console.log(e))\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDislayMediaSuccess = (stream) => {\n\t\ttry {\n\t\t\twindow.localStream.getTracks().forEach(track => track.stop())\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\n\t\twindow.localStream = stream\n\t\tthis.localVideoref.current.srcObject = stream\n\n\t\tfor (let id in connections) {\n\t\t\tif (id === socketId) continue\n\n\t\t\tconnections[id].addStream(window.localStream);\n\n\t\t\tconnections[id].createOffer().then((description) => {\n\t\t\t\tconnections[id].setLocalDescription(description)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tsocket.emit('signal', id, JSON.stringify({ 'sdp': connections[id].localDescription }));\n\t\t\t\t\t})\n\t\t\t\t\t.catch(e => console.log(e));\n\t\t\t});\n\t\t}\n\n\n\t\tstream.getVideoTracks()[0].onended = () => {\n\t\t\tthis.setState({\n\t\t\t\tscreen: false,\n\t\t\t}, () => {\n\t\t\t\ttry {\n\t\t\t\t\tlet tracks = this.localVideoref.current.srcObject.getTracks()\n\t\t\t\t\ttracks.forEach(track => track.stop())\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(e)\n\t\t\t\t}\n\n\t\t\t\tlet silence = () => {\n\t\t\t\t\tlet ctx = new AudioContext()\n\t\t\t\t\tlet oscillator = ctx.createOscillator()\n\t\t\t\t\tlet dst = oscillator.connect(ctx.createMediaStreamDestination())\n\t\t\t\t\toscillator.start()\n\t\t\t\t\tctx.resume()\n\t\t\t\t\treturn Object.assign(dst.stream.getAudioTracks()[0], { enabled: false });\n\t\t\t\t}\n\n\t\t\t\tlet black = ({ width = 640, height = 480 } = {}) => {\n\t\t\t\t\tlet canvas = Object.assign(document.createElement(\"canvas\"), { width, height });\n\t\t\t\t\tcanvas.getContext('2d').fillRect(0, 0, width, height);\n\t\t\t\t\tlet stream = canvas.captureStream();\n\t\t\t\t\treturn Object.assign(stream.getVideoTracks()[0], { enabled: false });\n\t\t\t\t}\n\n\t\t\t\tlet blackSilence = (...args) => new MediaStream([black(...args), silence()]);\n\t\t\t\twindow.localStream = blackSilence()\n\t\t\t\tthis.localVideoref.current.srcObject = window.localStream\n\n\t\t\t\tthis.getUserMedia()\n\t\t\t})\n\t\t};\n\t}\n\n\n\tgotMessageFromServer = (fromId, message) => {\n\t\tvar signal = JSON.parse(message)\n\n\t\tif (fromId !== socketId) {\n\t\t\tif (signal.sdp) {\n\t\t\t\tconnections[fromId].setRemoteDescription(new RTCSessionDescription(signal.sdp)).then(() => {\n\t\t\t\t\tif (signal.sdp.type === 'offer') {\n\t\t\t\t\t\tconnections[fromId].createAnswer().then((description) => {\n\t\t\t\t\t\t\tconnections[fromId].setLocalDescription(description).then(() => {\n\t\t\t\t\t\t\t\tsocket.emit('signal', fromId, JSON.stringify({ 'sdp': connections[fromId].localDescription }));\n\t\t\t\t\t\t\t}).catch(e => console.log(e));\n\t\t\t\t\t\t}).catch(e => console.log(e));\n\t\t\t\t\t}\n\t\t\t\t}).catch(e => console.log(e));\n\t\t\t}\n\n\t\t\tif (signal.ice) {\n\t\t\t\tconnections[fromId].addIceCandidate(new RTCIceCandidate(signal.ice)).catch(e => console.log(e));\n\t\t\t}\n\t\t}\n\t}\n\n\tconnectToSocketServer = () => {\n\t\tsocket = io.connect(server_url, { secure: true })\n\n\t\tsocket.on('signal', this.gotMessageFromServer)\n\n\t\tsocket.on('connect', () => {\n\n\t\t\tconsole.log(\"connected\")\n\t\t\tsocket.emit('join-call', window.location.href)\n\t\t\tsocketId = socket.id\n\n\t\t\tsocket.on('chat-message', this.addMessage)\n\n\t\t\tsocket.on('user-left', function (id) {\n\t\t\t\tvar video = document.querySelector(`[data-socket=\"${id}\"]`);\n\t\t\t\tif (video !== null) {\n\t\t\t\t\telms--\n\t\t\t\t\tvideo.parentNode.removeChild(video);\n\n\t\t\t\t\tvar main = document.getElementById('main')\n\t\t\t\t\tvar videos = main.querySelectorAll(\"video\")\n\n\t\t\t\t\tvar widthMain = main.offsetWidth\n\n\t\t\t\t\tvar minWidth = \"30%\"\n\t\t\t\t\tif ((widthMain * 30 / 100) < 300) {\n\t\t\t\t\t\tminWidth = \"300px\"\n\t\t\t\t\t}\n\n\t\t\t\t\tvar minHeight = \"40%\"\n\n\t\t\t\t\tvar height = String(100 / elms) + \"%\"\n\t\t\t\t\tvar width = \"\"\n\t\t\t\t\tif (elms === 1 || elms === 2) {\n\t\t\t\t\t\twidth = \"45%\"\n\t\t\t\t\t\theight = \"100%\"\n\t\t\t\t\t} else if (elms === 3 || elms === 4) {\n\t\t\t\t\t\twidth = \"35%\"\n\t\t\t\t\t\theight = \"50%\"\n\t\t\t\t\t} else {\n\t\t\t\t\t\twidth = String(100 / elms) + \"%\"\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfor (let a = 0; a < videos.length; ++a) {\n\t\t\t\t\t\tvideos[a].style.minWidth = minWidth\n\t\t\t\t\t\tvideos[a].style.minHeight = minHeight\n\t\t\t\t\t\tvideos[a].style.setProperty(\"width\", width)\n\t\t\t\t\t\tvideos[a].style.setProperty(\"height\", height)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsocket.on('user-joined', function (id, clients) {\n\t\t\t\tconsole.log(\"joined\")\n\n\t\t\t\tclients.forEach(function (socketListId) {\n\t\t\t\t\tconnections[socketListId] = undefined\n\t\t\t\t\tif (connections[socketListId] === undefined) {\n\t\t\t\t\t\tconsole.log(\"new entry\")\n\t\t\t\t\t\tconnections[socketListId] = new RTCPeerConnection(peerConnectionConfig);\n\t\t\t\t\t\t//Wait for their ice candidate       \n\t\t\t\t\t\tconnections[socketListId].onicecandidate = function (event) {\n\t\t\t\t\t\t\tif (event.candidate != null) {\n\t\t\t\t\t\t\t\tsocket.emit('signal', socketListId, JSON.stringify({ 'ice': event.candidate }));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//Wait for their video stream\n\t\t\t\t\t\tconnections[socketListId].onaddstream = (event) => {\n\n\t\t\t\t\t\t\t// TODO mute button, full screen button\n\n\t\t\t\t\t\t\tvar searchVidep = document.querySelector(`[data-socket=\"${socketListId}\"]`);\n\t\t\t\t\t\t\tif (searchVidep !== null) { // se non faccio questo check crea un quadrato vuoto inutile\n\t\t\t\t\t\t\t\tsearchVidep.srcObject = event.stream\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telms = clients.length\n\t\t\t\t\t\t\t\tvar main = document.getElementById('main')\n\t\t\t\t\t\t\t\tvar videos = main.querySelectorAll(\"video\")\n\n\t\t\t\t\t\t\t\tvar widthMain = main.offsetWidth\n\n\t\t\t\t\t\t\t\tvar minWidth = \"30%\"\n\t\t\t\t\t\t\t\tif ((widthMain * 30 / 100) < 300) {\n\t\t\t\t\t\t\t\t\tminWidth = \"300px\"\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar minHeight = \"40%\"\n\n\t\t\t\t\t\t\t\tvar height = String(100 / elms) + \"%\"\n\t\t\t\t\t\t\t\tvar width = \"\"\n\t\t\t\t\t\t\t\tif (elms === 1 || elms === 2) {\n\t\t\t\t\t\t\t\t\twidth = \"45%\"\n\t\t\t\t\t\t\t\t\theight = \"100%\"\n\t\t\t\t\t\t\t\t} else if (elms === 3 || elms === 4) {\n\t\t\t\t\t\t\t\t\twidth = \"35%\"\n\t\t\t\t\t\t\t\t\theight = \"50%\"\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\twidth = String(100 / elms) + \"%\"\n\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\tfor (let a = 0; a < videos.length; ++a) {\n\t\t\t\t\t\t\t\t\tvideos[a].style.minWidth = minWidth\n\t\t\t\t\t\t\t\t\tvideos[a].style.minHeight = minHeight\n\t\t\t\t\t\t\t\t\tvideos[a].style.setProperty(\"width\", width)\n\t\t\t\t\t\t\t\t\tvideos[a].style.setProperty(\"height\", height)\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar video = document.createElement('video')\n\t\t\t\t\t\t\t\tvideo.style.minWidth = minWidth\n\t\t\t\t\t\t\t\tvideo.style.minHeight = minHeight\n\t\t\t\t\t\t\t\tvideo.style.maxHeight = \"100%\"\n\t\t\t\t\t\t\t\tvideo.style.setProperty(\"width\", width)\n\t\t\t\t\t\t\t\tvideo.style.setProperty(\"height\", height)\n\t\t\t\t\t\t\t\tvideo.style.margin = \"10px\"\n\t\t\t\t\t\t\t\tvideo.style.borderStyle = \"solid\"\n\t\t\t\t\t\t\t\tvideo.style.borderColor = \"#bdbdbd\"\n\t\t\t\t\t\t\t\tvideo.style.objectFit = \"fill\"\n\n\t\t\t\t\t\t\t\tvideo.setAttribute('data-socket', socketListId);\n\t\t\t\t\t\t\t\tvideo.srcObject = event.stream\n\t\t\t\t\t\t\t\tvideo.autoplay = true;\n\t\t\t\t\t\t\t\t// video.muted       = true;\n\t\t\t\t\t\t\t\tvideo.playsinline = true;\n\n\t\t\t\t\t\t\t\tmain.appendChild(video)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//Add the local video stream\n\t\t\t\t\t\tif (window.localStream !== undefined && window.localStream !== null) {\n\t\t\t\t\t\t\tconnections[socketListId].addStream(window.localStream);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlet silence = () => {\n\t\t\t\t\t\t\t\tlet ctx = new AudioContext()\n\t\t\t\t\t\t\t\tlet oscillator = ctx.createOscillator()\n\t\t\t\t\t\t\t\tlet dst = oscillator.connect(ctx.createMediaStreamDestination())\n\t\t\t\t\t\t\t\toscillator.start()\n\t\t\t\t\t\t\t\tctx.resume()\n\t\t\t\t\t\t\t\treturn Object.assign(dst.stream.getAudioTracks()[0], { enabled: false });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet black = ({ width = 640, height = 480 } = {}) => {\n\t\t\t\t\t\t\t\tlet canvas = Object.assign(document.createElement(\"canvas\"), { width, height });\n\t\t\t\t\t\t\t\tcanvas.getContext('2d').fillRect(0, 0, width, height);\n\t\t\t\t\t\t\t\tlet stream = canvas.captureStream();\n\t\t\t\t\t\t\t\treturn Object.assign(stream.getVideoTracks()[0], { enabled: false });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet blackSilence = (...args) => new MediaStream([black(...args), silence()]);\n\t\t\t\t\t\t\twindow.localStream = blackSilence()\n\t\t\t\t\t\t\tconnections[socketListId].addStream(window.localStream);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (id !== socketId) {\n\t\t\t\t\t// Create an offer to connect with your local description\n\t\t\t\t\tconnections[id].createOffer().then((description) => {\n\t\t\t\t\t\tconnections[id].setLocalDescription(description)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tsocket.emit('signal', id, JSON.stringify({ 'sdp': connections[id].localDescription }));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(e => console.log(e));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t})\n\t}\n\n\n\thandleVideo = () => {\n\t\tthis.setState({\n\t\t\tvideo: !this.state.video,\n\t\t}, () => {\n\t\t\tthis.getUserMedia()\n\t\t})\n\t}\n\n\thandleAudio = () => {\n\t\tthis.setState({\n\t\t\taudio: !this.state.audio,\n\t\t}, () => {\n\t\t\tthis.getUserMedia()\n\t\t})\n\t}\n\n\thandleScreen = () => {\n\t\tthis.setState({\n\t\t\tscreen: !this.state.screen\n\t\t}, () => {\n\t\t\tthis.getDislayMedia()\n\t\t})\n\t}\n\n\thandleEndCall = () => {\n\t\ttry {\n\t\t\tlet tracks = this.localVideoref.current.srcObject.getTracks()\n\t\t\ttracks.forEach(track => track.stop())\n\t\t} catch (e) {\n\n\t\t}\n\n\t\twindow.location.href = \"/\"\n\t}\n\n\n\topenChat = () => {\n\t\tthis.setState({\n\t\t\tshowModal: true,\n\t\t\tnewmessages: 0,\n\t\t})\n\t}\n\n\tcloseChat = () => {\n\t\tthis.setState({\n\t\t\tshowModal: false,\n\t\t})\n\t}\n\n\thandleMessage = (e) => {\n\t\tthis.setState({\n\t\t\tmessage: e.target.value,\n\t\t})\n\t}\n\n\taddMessage = (data, sender) => {\n\t\tthis.setState(prevState => ({\n\t\t\tmessages: [...prevState.messages, { \"sender\": sender, \"data\": data }],\n\t\t}))\n\n\t\tif (sender !== socketId) {\n\t\t\tthis.setState({\n\t\t\t\tnewmessages: this.state.newmessages + 1\n\t\t\t})\n\t\t}\n\n\t}\n\n\tsendMessage = () => {\n\t\tsocket.emit('chat-message', this.state.message)\n\t\tthis.setState({\n\t\t\tmessage: \"\",\n\t\t})\n\t}\n\n\tcopyUrl = (e) => {\n\t\tvar text = window.location.href\n\n\t\tif (!navigator.clipboard) {\n\t\t\tvar textArea = document.createElement(\"textarea\")\n\t\t\ttextArea.value = text\n\t\t\tdocument.body.appendChild(textArea)\n\t\t\ttextArea.focus()\n\t\t\ttextArea.select()\n\t\t\ttry {\n\t\t\t\tdocument.execCommand('copy')\n\t\t\t\tmessage.success(\"Link copied to clipboard!\")\n\t\t\t} catch (err) {\n\t\t\t\tmessage.error(\"Failed to copy\")\n\t\t\t}\n\t\t\tdocument.body.removeChild(textArea)\n\t\t\treturn\n\t\t}\n\t\tnavigator.clipboard.writeText(text).then(function () {\n\t\t\tmessage.success(\"Link copied to clipboard!\")\n\t\t}, function (err) {\n\t\t\tmessage.error(\"Failed to copy\")\n\t\t})\n\t}\n\n\thandleUsername = (e) => {\n\t\tthis.setState({\n\t\t\tusername: e.target.value\n\t\t})\n\t}\n\n\tconnect = () => {\n\t\tthis.setState({\n\t\t\taskForUsername: false,\n\t\t}, () => {\n\t\t\tthis.getMedia()\n\t\t})\n\t}\n\n\tisChromeOrFirefox = function() {\n\t\tvar userAgent = (navigator && navigator.userAgent || '').toLowerCase()\n\t\tvar vendor = (navigator && navigator.vendor || '').toLowerCase()\n\t\tvar matchChrome = /google inc/.test(vendor) ? userAgent.match(/(?:chrome|crios)\\/(\\d+)/) : null\n\t\tvar matchFirefox = userAgent.match(/(?:firefox|fxios)\\/(\\d+)/)\n\t\treturn matchChrome !== null || matchFirefox !== null\n\t}\n\n\trender() {\n\t\tif(this.isChromeOrFirefox() === false){\n\t\t\treturn (\n\t\t\t\t<div style={{\n\t\t\t\t\tbackground: \"white\", width: \"30%\", height: \"auto\", padding: \"20px\", minWidth: \"400px\",\n\t\t\t\t\ttextAlign: \"center\", margin: \"auto\", marginTop: \"50px\", justifyContent: \"center\"\n\t\t\t\t}}>\n\t\t\t\t\t<h1>Use Chrome or Firefox</h1>\n\t\t\t\t</div>\n\t\t\t)\n\t\t}\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{this.state.askForUsername === true ?\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div style={{\n\t\t\t\t\t\t\tbackground: \"white\", width: \"30%\", height: \"auto\", padding: \"20px\", minWidth: \"400px\",\n\t\t\t\t\t\t\ttextAlign: \"center\", margin: \"auto\", marginTop: \"50px\", justifyContent: \"center\"\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t<p style={{ margin: 0, fontWeight: \"bold\", paddingRight: \"50px\" }}>Set your username</p>\n\t\t\t\t\t\t\t<Input placeholder=\"Username\" value={this.state.username} onChange={e => this.handleUsername(e)} />\n\t\t\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={this.connect} style={{ margin: \"20px\" }}>Connect</Button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div style={{ justifyContent: \"center\", textAlign: \"center\", paddingTop: \"40px\" }}>\n\t\t\t\t\t\t\t<video id=\"my-video\" ref={this.localVideoref} autoPlay muted style={{\n\t\t\t\t\t\t\t\tborderStyle: \"solid\",\n\t\t\t\t\t\t\t\tborderColor: \"#bdbdbd\",\n\t\t\t\t\t\t\t\tobjectFit: \"fill\",\n\t\t\t\t\t\t\t\twidth: \"60%\",\n\t\t\t\t\t\t\t\theight: \"30%\"\n\t\t\t\t\t\t\t}}></video>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t:\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div className=\"btn-down\" style={{ backgroundColor: \"whitesmoke\", color: \"whitesmoke\", textAlign: \"center\" }}>\n\t\t\t\t\t\t\t<IconButton style={{ color: \"#424242\" }} onClick={this.handleVideo}>\n\t\t\t\t\t\t\t\t{(this.state.video === true) ? <VideocamIcon /> : <VideocamOffIcon />}\n\t\t\t\t\t\t\t</IconButton>\n\n\t\t\t\t\t\t\t<IconButton style={{ color: \"#f44336\" }} onClick={this.handleEndCall}>\n\t\t\t\t\t\t\t\t<CallEndIcon />\n\t\t\t\t\t\t\t</IconButton>\n\n\t\t\t\t\t\t\t<IconButton style={{ color: \"#424242\" }} onClick={this.handleAudio}>\n\t\t\t\t\t\t\t\t{this.state.audio === true ? <MicIcon /> : <MicOffIcon />}\n\t\t\t\t\t\t\t</IconButton>\n\n\t\t\t\t\t\t\t{this.state.screenAvailable === true ?\n\t\t\t\t\t\t\t\t<IconButton style={{ color: \"#424242\" }} onClick={this.handleScreen}>\n\t\t\t\t\t\t\t\t\t{this.state.screen === true ? <ScreenShareIcon /> : <StopScreenShareIcon />}\n\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t: null}\n\n\t\t\t\t\t\t\t<Badge badgeContent={this.state.newmessages} max={999} color=\"secondary\" onClick={this.openChat}>\n\t\t\t\t\t\t\t\t<IconButton style={{ color: \"#424242\" }} onClick={this.openChat}>\n\t\t\t\t\t\t\t\t\t<ChatIcon />\n\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<Modal show={this.state.showModal} onHide={this.closeChat} style={{ zIndex: \"999999\" }}>\n\t\t\t\t\t\t\t<Modal.Header closeButton>\n\t\t\t\t\t\t\t\t<Modal.Title>Chat Room</Modal.Title>\n\t\t\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t\t\t<Modal.Body style={{ overflow: \"auto\", overflowY: \"auto\", height: \"400px\" }} >\n\t\t\t\t\t\t\t\t{this.state.messages.length > 0 ? this.state.messages.map((item, index) => (\n\t\t\t\t\t\t\t\t\t<div key={item.sender + item.data + index}>\n\t\t\t\t\t\t\t\t\t\t<b>{item.sender}</b>\n\t\t\t\t\t\t\t\t\t\t<p style={{ wordBreak: \"break-all\" }}>{item.data}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)) : <p>No message yet</p>}\n\t\t\t\t\t\t\t</Modal.Body>\n\t\t\t\t\t\t\t<Modal.Footer className=\"div-send-msg\">\n\t\t\t\t\t\t\t\t<Input placeholder=\"Message\" value={this.state.message} onChange={e => this.handleMessage(e)} />\n\t\t\t\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={this.sendMessage}>Send</Button>\n\t\t\t\t\t\t\t</Modal.Footer>\n\t\t\t\t\t\t</Modal>\n\n\t\t\t\t\t\t<div className=\"container\">\n\t\t\t\t\t\t\t<div style={{ paddingTop: \"20px\" }}>\n\t\t\t\t\t\t\t\t<Input value={window.location.href} disable=\"true\"></Input>\n\t\t\t\t\t\t\t\t<Button style={{\n\t\t\t\t\t\t\t\t\tbackgroundColor: \"#3f51b5\",\n\t\t\t\t\t\t\t\t\tcolor: \"whitesmoke\",\n\t\t\t\t\t\t\t\t\tmarginLeft: \"20px\",\n\t\t\t\t\t\t\t\t\tmarginTop: \"10px\",\n\t\t\t\t\t\t\t\t\twidth: \"120px\",\n\t\t\t\t\t\t\t\t\tfontSize: \"10px\"\n\t\t\t\t\t\t\t\t}} onClick={this.copyUrl}>Copy invite link</Button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Row id=\"main\" className=\"flex-container\" style={{ margin: 0, padding: 0 }}>\n\t\t\t\t\t\t\t\t<video id=\"my-video\" ref={this.localVideoref} autoPlay muted style={{\n\t\t\t\t\t\t\t\t\tborderStyle: \"solid\",\n\t\t\t\t\t\t\t\t\tborderColor: \"#bdbdbd\",\n\t\t\t\t\t\t\t\t\tmargin: \"10px\",\n\t\t\t\t\t\t\t\t\tobjectFit: \"fill\",\n\t\t\t\t\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\t\t\t\t\theight: \"100%\"\n\t\t\t\t\t\t\t\t}}></video>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Video;","import React, { Component } from 'react';\nimport { Input, Button, IconButton } from '@material-ui/core';\nimport GitHubIcon from '@material-ui/icons/GitHub';\nimport \"./Home.css\"\n\nclass Home extends Component {\n  \tconstructor (props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\turl: ''\n\t\t}\n\t}\n\n\thandleChange = (e) => {\n\t\tthis.setState({\n\t\t\turl: e.target.value\n\t\t})\n\t}\n\n\tjoin = () => {\n\t\tif (this.state.url !== \"\") {\n\t\t\tif (this.state.url.includes(window.location.href) || this.state.url.includes(window.location.href.substring(8, window.location.href.length))) {\n\t\t\t\twindow.location.href = this.state.url\n\t\t\t}\n\t\t\twindow.location.href = `/${this.state.url}`\n\t\t} else {\n\t\t\tvar url = Math.random().toString(36).substring(2, 7)\n\t\t\twindow.location.href = `/${url}`\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"container2\">\n\t\t\t\t<div style={{fontSize: \"14px\", background: \"white\", width: \"10%\", textAlign: \"center\", margin: \"auto\", marginBottom: \"10px\"}}>\n\t\t\t\t\tSource code: \n\t\t\t\t\t<IconButton style={{color: \"black\"}} onClick={() => window.location.href=\"https://github.com/0x5eba/Video-Meeting\"}>\n\t\t\t\t\t\t<GitHubIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div>\n\t\t\t\t\t<h1 style={{ fontSize: \"45px\" }}>Video Meeting</h1>\n\t\t\t\t\t<p style={{ fontWeight: \"200\" }}>Video conference website that lets you stay in touch with all your friends.</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div style={{\n\t\t\t\t\tbackground: \"white\", width: \"30%\", height: \"auto\", padding: \"20px\", minWidth: \"400px\",\n\t\t\t\t\ttextAlign: \"center\", margin: \"auto\", marginTop: \"100px\"\n\t\t\t\t}}>\n\t\t\t\t\t<p style={{ margin: 0, fontWeight: \"bold\", paddingRight: \"50px\" }}>Start or join a meeting</p>\n\t\t\t\t\t<Input placeholder=\"URL\" onChange={e => this.handleChange(e)} />\n\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={this.join} style={{ margin: \"20px\" }}>Go</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Home;","import React, { Component } from 'react'\nimport Video from './Video'\nimport Home from './Home'\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nclass App extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Router>\n\t\t\t\t\t<Switch>\n\t\t\t\t\t\t<Route path=\"/\" exact component={Home} />\n\t\t\t\t\t\t<Route path=\"/:url\" component={Video} />\n\t\t\t\t\t</Switch>\n\t\t\t\t</Router>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t// [::1] is the IPv6 localhost address.\n\twindow.location.hostname === '[::1]' ||\n\t// 127.0.0.0/8 are considered localhost for IPv4.\n\twindow.location.hostname.match(\n\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl, {\n\t\theaders: { 'Service-Worker': 'script' },\n\t})\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t'No internet connection found. App is running in offline mode.'\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready\n\t\t\t.then(registration => {\n\t\t\t\tregistration.unregister();\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.error(error.message);\n\t\t\t});\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n\t<App />,\n\tdocument.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}